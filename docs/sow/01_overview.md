# 01. SOW Overview — sound-stamp

## 1. プロジェクト概要

**sound-stamp** は、配信音声に対して以下 3 種類のウォーターマークを埋め込み・解析する Web サービスである。

- **A 型 (Amplitude Mark)**  
  振幅情報を用いた、スペクトログラム上で視認可能なウォーターマーク。
- **B 型 (Phase Mark)**  
  位相情報を用いた、専用解析で視認可能なウォーターマーク。
- **C 型 (Crypto Mark / Token Mark)**  
  128bit トークン（署名付き）を不可視で埋め込み、盗用時の強い証拠とするウォーターマーク。

主目的は、配信者が自身の配信音源を不正利用された際に、

- スペクトログラム上で視覚的に確認できる証拠（A/B）
- 署名付きトークンによる暗号学的な証拠（C）

を提示できるようにすることである。

## 2. 技術前提

- **STFT / IFFT** による周波数領域処理
- 64×256 ブロック構造（時間方向 64 フレーム × 周波数方向 256 ビン）
- **WebAudio API** によるノイズ生成・再生
- **Firestore** によるトークン管理
- **Firebase Hosting** による静的 Web ホスティング
- **Firebase Authentication（Google ログイン）** によるユーザー認証

## 3. フェーズ分割

1. **Phase A/B**  
   - A/B ウォーターマーク機能を実装  
   - 完全にフロントエンド（静的ホスティング）のみで完結させる  
   - C を後から挿し込めるように拡張ポイントを持つ設計とする。

2. **Phase C**  
   - 128bit トークン（署名付き）の埋め込み・解析機能を追加  
   - Firestore + Cloud Functions を利用し、秘密鍵・署名・検証 API を実装。

## 4. 成果物サマリ

- ウォーターマーク生成ライブラリ（TypeScript, `@soundstamp/core`）
- 解析ライブラリ（TypeScript）
- Next.js ベースの Web UI（OBS ブラウザソース対応）
- Firebase Hosting / Firestore / Functions 構成
- 技術仕様書（本 SOW および派生ドキュメント）

## 5. 非目標

- リアルタイム（サブ 10ms レイテンシ）でのストリーム埋め込み  
- 他社商用 DRM レベルの耐改ざん性の完全再現  
- マルチテナント・大規模マルチユーザー同時利用対応（当面はスモールスタート）
